#!/usr/bin/env bash
#? Show tb2 help message

set -euo pipefail

base_dir=$(dirname "${BASH_SOURCE[0]}")/..
subcmd_dir="$base_dir/subcmds"

source "$base_dir/utils.sh"

info "tb2 - TextBook ToolBox"
log  "GitHub automation & textbook builder CLI"
echo

info "USAGE"
log  "  tb2 <subcmd> [options]"
echo

info "DESCRIPTION"
log  "  tb2 automates GitHub operations for textbook creation."
log  "  It manages Books, Chapters, Pages, Issues, Branches, and Projects."
echo

info "SUBCOMMANDS"
for cmd in "$subcmd_dir"/*; do
  name=$(basename "$cmd")
  if [[ "$name" == "_template" ]]; then
    continue
  fi
  desc=$(grep '^#?' "$cmd" | sed 's/^#? //' | sed 's/^/      /')
  [[ -z "$desc" ]] && desc="      (no description)"
  printf "  %-10s\n%s\n" "$name" "$desc"
done

echo

info "FLAGS"
log  "  -h, --help        Show help for a specific subcommand"
log  "  -i                Start tb2 in interactive mode"
echo

info "EXAMPLES"
log "  see github.com/techno-tutors/tb2/"
echo