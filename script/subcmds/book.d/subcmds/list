#!/usr/bin/env bash
#? List existing book both remote and local
#? Usage: tb2 book list
#? config dependencies:  MDBOOK_SRC_DIR

set -euo pipefail


. "$ROOT/utils.sh"

log "Checking for config..."

useConf MDBOOK_SRC_DIR srcDir
useConf GH_OWNER_NAME name
useConf GH_REPO_NAME repoName

log "done."

log "=Remote [GitHub Issues]="
log "=========================="
if tb2_isManualMode; then
  warn "Remote list is disabled in manual mode."
else
  run gh_findIssue "$name/$repoName" "Book:"
fi
log "=Local [mdBook directory]="
log "=========================="
find "${srcDir:-src}" -maxdepth 1 -mindepth 1 -type d -print0 | while IFS= read -r -d '' bookPath; do
	bookPath=$(basename "$bookPath")
	log "$bookPath"
done
log "========================"
exit 0
